<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="None">

    <link rel="canonical" href="https://github.com/FredGainza/generateACP/">
    <link rel="shortcut icon" href="img/favicon.ico">
    <title>generateACP</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/docco.min.css">
    <link href="assets/_mkdocstrings.css" rel="stylesheet">
    <link href="extra.css" rel="stylesheet">

    <script src="js/jquery-1.10.2.min.js" defer></script>
    <script src="js/bootstrap.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</head>

<body class="homepage">
    <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href=".">generateACP</a>

            <!-- Expanded navigation -->
            <div id="navbar-collapse" class="navbar-collapse collapse">

                <ul class="nav navbar-nav ml-auto">
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse"
                            data-target="#toc-collapse" title="Table des matières">
                            <span class="fa fa-angle-down"></span>
                        </button>
                    </div>

                    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
                        <ul class="nav flex-column">

                            <li class="nav-item" data-level="1"><a href="#generateacp" class="nav-link">generateACP</a>
                                <ul class="nav flex-column">
                                    <li class="nav-item" data-level="2"><a href="#1-presentation" class="nav-link">1.
                                            Présentation</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                    <li class="nav-item" data-level="2"><a href="#2-installation" class="nav-link">2.
                                            Installation</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                    <li class="nav-item" data-level="2"><a href="#3-detail-de-la-fonction"
                                            class="nav-link">3. Détail de la fonction</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                    <li class="nav-item" data-level="2"><a href="#4-exemple" class="nav-link">4.
                                            Exemple</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                    <li class="nav-item" data-level="2"><a href="#5-reference" class="nav-link">5.
                                            Reference</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                    <li class="nav-item" data-level="2"><a href="#6-about" class="nav-link">6. About</a>
                                        <ul class="nav flex-column">
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-9" role="main">

                <h1 id="generateacp">generateACP</h1>
                <h2 id="1-presentation">1. Présentation</h2>
                <p>Réalisation d'une ACP à partir d'un fichier .csv ou .xlsx de données.</p>
                <p><img alt="GitHub" src="https://kopadata.fr/imgs/logo-github_ok.png" /> <a
                        href="https://github.com/FredGainza/generateACP">Dépôt GitHub</a></p>
                <p>Structure de l'analyse réalisée :</p>
                <h4 id="information-sur-les-donnees">Information sur les données</h4>
                <pre><code>    * données initiales
    * données centrées réduites
</code></pre>
                <h4 id="recherche-du-nombre-de-facteurs-a-retenir">Recherche du nombre de facteurs à retenir</h4>
                <pre><code>    * graphique eboulis des valeurs propres
    * calcul de la proportion de variance expliquée
    * test des bâtons brisés
</code></pre>
                <h4 id="representation-des-individus">Représentation des individus</h4>
                <pre><code>    * coordonnées factorielles des individus
    * qualité de la représentation des individus (cos² de chaque individu par axe)
    * contribution des individus aux axes
</code></pre>
                <h4 id="representation-des-variables">Représentation des variables</h4>
                <pre><code>    * les vecteurs propres
    * corrélations par facteur
    * qualité de la représentation des variables (cos² de chaque variable par axe)
    * contribution des variables aux axes
</code></pre>
                <h4 id="traitement-des-variables-supplementaires">Traitement des variables supplémentaires</h4>
                <pre><code>    * variables illustratives quantitatives
    * variables illustratives qualitatives
</code></pre>
                <h4 id="representation-graphique-pour-chaque-plan-factoriel">Représentation graphique (pour chaque plan
                    factoriel)</h4>
                <pre><code>    * Projection des individus
    * Cercle des corrélations
</code></pre>
                <h2 id="2-installation">2. Installation</h2>
                <h3 id="exemple-avec-anaconda">Exemple avec Anaconda</h3>
                <pre><code class="language-bash">    ### Créer un dossier pour le projet
    $ cd /vers/dossier/testACP

    ### Créer un nouvel environnement
    $ conda create -n envAcp python=3.9
    ### Activer le nouvel environnement
    $ conda activate envAcp

    ### Installer le module generateAcp
    $ pip install git+https://github.com/FredGainza/generateACP.git
</code></pre>
                <p>Pour utiliser le module dans un notebook, il faut importer la fonction <strong>acp_global()</strong>
                    :</p>
                <pre><code class="language-python">    from generateACP import acp_global
</code></pre>
                <p>Les modules suivants seront automatiquement installés :</p>
                <ul>
                    <li>pandas</li>
                    <li>numpy</li>
                    <li>scikit-learn</li>
                    <li>matplotlib</li>
                    <li>jupyter</li>
                    <li>adjustText</li>
                    <li>pdfservices-sdk</li>
                    <li>openpyxl</li>
                </ul>
                <h2 id="3-detail-de-la-fonction">3. Détail de la fonction</h2>
                <hr />
                <h3 id="preambule">Préambule</h3>
                <hr />
                <p>Le seul paramètre obligatoire de la fonction est le df des données, à formater de la façon
                    suivante&nbsp;:</p>
                <p>Pour les variables servant aux calculs de l'ACP (ne concerne pas les variables illustratives)&nbsp;:
                </p>
                <pre><code>- mettre en index la variable d'observation (variable qualitative générallement)
- les colonnes du df ne doivent contenir UNIQUEMENT DES VARIABLES QUANTITATIVES
- les variables qualitatives doivent donc être transformées en variables quantitatives
</code></pre>
                <p>Si votre jeu de données contient les variables explicatives et illustratives, vous devez créer
                    plusieurs df (avec toujours la variable d'observation en index), soit&nbsp;:</p>
                <pre><code>- un df avec les variables quantitaives explicatives
- un df avec les variables quantitatives illustratives
- un df avec les variables qualitatives explicatives
</code></pre>
                <p style="margin-bottom: 1.5rem !important;">Se référer à l'exemple <a href="https://github.com/FredGainza/generateACP/tree/main/docs"
                        target="_blank"><em>analyse_acp_exemple.ipynb</em></a> pour plus de détails.</p>
                <hr />
                <h3 id="fonction-acp_global">Fonction acp_global</h3>
                <hr />
                <div class="doc doc-object doc-module">
                    <a id="generateACP"></a>
                    <div class="doc doc-contents first">
                        <div class="doc doc-children">
                            <div class="doc doc-object doc-function">
                                <h5 id="generateACP.acp_global" class="doc doc-heading">
                                    <code class="highlight language-python"><span class="n">acp_global</span><span
                                            class="p">(</span><span class="n">df</span><span class="p">,</span> <span
                                            class="n">axis_ranks</span><span class="o">=</span><span
                                            class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span
                                            class="mi">1</span><span class="p">)],</span> <span
                                            class="n">group</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">group_special</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">varSupp</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">varSuppQual</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">labels</span><span class="o">=</span><span
                                            class="kc">True</span><span class="p">,</span> <span
                                            class="n">labels_ind</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">legend_label</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">version_name</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">graph_only</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">graph_only_acp</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">data_only</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">color_titles</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">,</span> <span
                                            class="n">palette_color</span><span class="o">=</span><span
                                            class="kc">None</span><span class="p">)</span></code>
                                </h5>
                                <div class="doc doc-contents ">
                                    <p><strong>Parameters:</strong></p>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Type</th>
                                                <th>Description</th>
                                                <th>Default</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>df</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df initial structuré pour une ACP:</p>
                                                    <ul>
                                                        <li>en ligne: des individus / observations</li>
                                                        <li>en colonne: les variables explicatives quantitatives </li>
                                                        <li>en index: la variable des observations</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <em>required</em>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>axis_ranks</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>les dimensions du / des plan(s) factoriels à étudier</p>
                                                    <ul>
                                                        <li>vérifier que les degrés factortiels ne soient pas supérieurs
                                                            aux nombres de variables</li>
                                                        <li>
                                                            <p>possible de lancer la fonction acp_global() pour
                                                                connaitre le résultat des tests de recherche du nombre
                                                                de facteurs à retenir (eboulis des valeurs propres avec
                                                                proportion cumulée de la variance expliquée, test
                                                                des bâtons brisés) en laissant la valeur des paramètres
                                                                par défaut</p>
                                                            <p>Exemple: en supposant que:</p>
                                                            <ul>
                                                                <li>df soit le nom du DataFrame des données initiales
                                                                </li>
                                                                <li>resultat_acp soit le nom donné au résultat de la
                                                                    fonction :
                                                                    <pre><code>resultat_acp = acp_globale(df)
</code></pre>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>[(0, 1)]</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>group</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>clustering</p>
                                                    <ul>
                                                        <li>valeur acceptée : nom de la colonne de groupe</li>
                                                        <li>il faut donc que le df initial comporte cette colonne</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>group_special</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>liste d'individus constituant un groupe particulier (individus
                                                        particuliers de la variable en index)</p>
                                                    <ul>
                                                        <li>valeur acceptée : liste d'individus</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>varSupp</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>variables illustratives quantitatives</p>
                                                    <ul>
                                                        <li>
                                                            <p>valeur acceptée : df avec</p>
                                                            <ul>
                                                                <li>même nb de lignes que le df initial (les mêmes
                                                                    individus)</li>
                                                                <li>en colonnes les variables illustratives
                                                                    quantitatives</li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>varSuppQual</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>variables illustratives qualitatives</p>
                                                    <ul>
                                                        <li>
                                                            <p>valeur acceptée : df avec</p>
                                                            <ul>
                                                                <li>même nb de lignes que le df initial (les mêmes
                                                                    individus)</li>
                                                                <li>en colonnes les variables illustratives qualitatives
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>labels</code></td>
                                                <td>
                                                    <code>boolean</code>
                                                </td>
                                                <td>
                                                    <p>affichage des valeurs de la variable des observations (variable
                                                        en index)</p>
                                                    <ul>
                                                        <li>valeur acceptée : True or None</li>
                                                        <li>NB : si labels = True, alors labels_ind = False (ne choisir
                                                            que 1 de ces 2 possibilités)</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>True</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>labels_ind</code></td>
                                                <td>
                                                    <code>boolean</code>
                                                </td>
                                                <td>
                                                    <p>affichage de l'indice des valeurs de la variable des observations
                                                        (variable en index)</p>
                                                    <ul>
                                                        <li>valeur acceptée : True or None</li>
                                                        <li>NB : si labels_ind = True, alors labels = False (ne choisir
                                                            que 1 de ces 2 possibilités)</li>
                                                        <li>intérêt de cette option: facilite la lecture du graphique
                                                            "Projection des individus", notamment si le
                                                            nombre d'oservations (nombre de lignes) est important</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>legend_label</code></td>
                                                <td>
                                                    <code>boolean</code>
                                                </td>
                                                <td>
                                                    <p>affichage des correspondances indice et valeur de la variable
                                                        d'observation (valable ssi labels_ind=True)</p>
                                                    <ul>
                                                        <li>valeur acceptée : True or None</li>
                                                        <li>si True, une légende de correspondance entre index affiché
                                                            sur le graphique et valeur réelle de la
                                                            variable d'observationb (en index) sera affichée sous le
                                                            graphique</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>version_name</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>prefixer les graphiques par un nom particulier</p>
                                                    <ul>
                                                        <li>
                                                            <p>valeur acceptée : string qui prefixera le nom des
                                                                graphiques </p>
                                                            <pre><code>ex : si version_name = "test1" alors le graphique "Eboulis des valeurs propres se nommera 
"test1_recherche_nb_facteurs_optimal.png"
</code></pre>
                                                        </li>
                                                        <li>
                                                            <p>intérêt: enregistrer tous les graphiques de différentes
                                                                versions d'une même ACP</p>
                                                        </li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>graph_only</code></td>
                                                <td>
                                                    <code>boolean</code>
                                                </td>
                                                <td>
                                                    <p>afficher seulement les graphiques (cercle de corrélation et
                                                        projection des individus)</p>
                                                    <ul>
                                                        <li>valeur acceptée : True or None</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>data_only</code></td>
                                                <td>
                                                    <code>boolean</code>
                                                </td>
                                                <td>
                                                    <p>ne rien renvoyer lors de l'appel de la fonction</p>
                                                    <ul>
                                                        <li>valeur acceptée : True or None</li>
                                                        <li>pour print un élément en particulier:<ul>
                                                                <li>donner un nom à la fonction lors de l'appel
                                                                    ex : resultat_acp = acp_perso(df, data_only=True)
                                                                </li>
                                                                <li>faire print(*resultat_acp)</li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>color_titles</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>liste de 3 couleurs au format hexadécimale (ex "#FFFFFF") pour
                                                        les titres h2, h3, h4</p>
                                                    <ul>
                                                        <li>couleurs des titres par défaut : ["#b08c20", "#3aa237",
                                                            "#29858a"]</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>palette_color</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>liste de couleurs au format hexadécimale (ex "#FFFFFF")pour les
                                                        graphiques de l'ACP</p>
                                                    <ul>
                                                        <li>couleurs par défaut : ["#b30f1c", "#0e6667", "#3353e1",
                                                            "#4ed147", "#d17e1a", "#2bb6b6",
                                                            "#514a39", "#4ed147", "#acb073", "#8b3afd", "#dec11b",
                                                            "#58f3e6", "#728e9d"]</li>
                                                    </ul>
                                                </td>
                                                <td>
                                                    <code>None</code>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <p><strong>Returns:</strong></p>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Type</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>val_centre_reduit</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df centré-réduit</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>valeurs_propres</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>valeurs propres</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>pct_inertie_par_facteur</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>pourcentage d'inertie par facteur</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>nb_groupes_opt</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>path du graph "Eboulis des valeurs propres"</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>test_batons_brises</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df valeurs propres / valeurs de seuil par facteur</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>coord_fact_ind</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>coordonnées factorielles des individus</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>cos2_ind</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>cos² des individus pour chaque axe factoriel</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>contribution_ind</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df globale: contribution des individus aux axes</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>ctr_ind_sorted_facteur_i</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df par facteur: les plus gros contributeurs à l'axe i</p>
                                                    <ul>
                                                        <li>pour tous les facteurs i</li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>vecteurs_propres</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>vecteurs propres des variables par facteur</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>matrice_cor</code></td>
                                                <td>
                                                    <code>array</code>
                                                </td>
                                                <td>
                                                    <p>matrice des corrélations des variables par facteur</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>cor_par_facteur</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>df de la matrice des corrélations </p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>cos2_var</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>cos² des variables par axe factoriel</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>contribution_var</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>contribution des variables aux axes </p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>cor_par_facteur_VarQttiveIllus</code></td>
                                                <td>
                                                    <code>DataFrame</code>
                                                </td>
                                                <td>
                                                    <p>corrélations des variables quantitatives illustratives par axe
                                                    </p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>resultats_tests</code></td>
                                                <td>
                                                    <code>list</code>
                                                </td>
                                                <td>
                                                    <p>résultats des différents tests interes (1 if ok else 0)</p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>centroides_a_b</code></td>
                                                <td>
                                                    <code>array</code>
                                                </td>
                                                <td>
                                                    <p>si clusters ou variable qualitative illustrative: coordonnées des
                                                        centroïdes</p>
                                                    <ul>
                                                        <li>pour chaque plan factoriel [a,b]</li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>graph_proj_ind_a_b</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>path du graph de projection des individus</p>
                                                    <ul>
                                                        <li>pour chaque plan factoriel [a,b]</li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>cercle_cor_a_b</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>path du graph du cercle des corrélations</p>
                                                    <ul>
                                                        <li>pour chaque plan factoriel [a,b]</li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>graph_combo_a_b</code></td>
                                                <td>
                                                    <code>str</code>
                                                </td>
                                                <td>
                                                    <p>path du graph composé (cf. les 2 graphs précédents)</p>
                                                    <ul>
                                                        <li>pour chaque plan factoriel [a,b]</li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><code>select_obs</code></td>
                                                <td>
                                                    <code>dict</code>
                                                </td>
                                                <td>
                                                    <p>dictionnaire :</p>
                                                    <ul>
                                                        <li>
                                                            <p>key:</p>
                                                            <ul>
                                                                <li>si labels=True alors valeurs de la variable
                                                                    d'observation</li>
                                                                <li>si labels_ind = True alors index des valeurs de la
                                                                    variable d'observation</li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>value:</p>
                                                            <ul>
                                                                <li>tuple composé de 2 df:<ul>
                                                                        <li>df données initiales de l'observation</li>
                                                                        <li>df données calculées pour cette observation
                                                                            <ul>
                                                                                <li>ses coordonnées factorielles</li>
                                                                                <li>sa qualité de représentation sur les
                                                                                    différents axes (cf. COS²)</li>
                                                                                <li>sa contribution aux différents axes
                                                                                </li>
                                                                            </ul>
                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <p style="margin-bottom: 0!important; text-align: justify!important;">Remarque : Un
                                        dossier se nommant "apc_graphs" est automatiquement créé lors de l'exécution de
                                        la fonction et contient les graphiques suivants :</p>
                                    <ul style="margin-bottom:1.25rem !important;">
                                        <li>Eboulis des valeurs propres</li>
                                        <li>Projection des individus sur les différents plans factoriels</li>
                                        <li>Cercle des corrélations sur les différents plans factoriels</li>
                                    </ul>



                                    <details class="quote">
                                        <summary style="font-size:115%;">
                                            Source code in <code>generateACP\__init__.py</code>
                                        </summary>
                                        <div class="highlight">
                                            <table class="highlighttable">
                                                <tr>
                                                    <td class="linenos">
                                                        <div class="linenodiv">
                                                            <pre><span></span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span></pre>
                                                        </div>
                                                    </td>
                                                    <td class="code">
                                                        <div>
                                                            <pre><span></span><code><span class="k">def</span> <span class="nf">acp_global</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">axis_ranks</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_special</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">varSupp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">varSuppQual</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels_ind</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">version_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_only</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_only_acp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_only</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color_titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette_color</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters:</span>

<span class="sd">            df (DataFrame): df initial structuré pour une ACP:</span>

<span class="sd">                - en ligne: des individus / observations</span>
<span class="sd">                - en colonne: les variables explicatives quantitatives </span>
<span class="sd">                - en index: la variable des observations</span>

<span class="sd">            axis_ranks (list): les dimensions du / des plan(s) factoriels à étudier</span>

<span class="sd">                - vérifier que les degrés factortiels ne soient pas supérieurs aux nombres de variables</span>
<span class="sd">                - possible de lancer la fonction acp_global() pour connaitre le résultat des tests de recherche du nombre</span>
<span class="sd">                de facteurs à retenir (eboulis des valeurs propres avec proportion cumulée de la variance expliquée, test</span>
<span class="sd">                des bâtons brisés) en laissant la valeur des paramètres par défaut</span>


<span class="sd">                    Exemple: en supposant que:</span>

<span class="sd">                    - df soit le nom du DataFrame des données initiales</span>
<span class="sd">                    - resultat_acp soit le nom donné au résultat de la fonction :</span>

<span class="sd">                            resultat_acp = acp_globale(df)</span>

<span class="sd">            group (str): clustering</span>

<span class="sd">                - valeur acceptée : nom de la colonne de groupe</span>
<span class="sd">                - il faut donc que le df initial comporte cette colonne</span>

<span class="sd">            group_special (list): liste d&#39;individus constituant un groupe particulier (individus particuliers de la variable en index)</span>

<span class="sd">                - valeur acceptée : liste d&#39;individus</span>

<span class="sd">            varSupp (DataFrame): variables illustratives quantitatives</span>

<span class="sd">                - valeur acceptée : df avec</span>

<span class="sd">                    - même nb de lignes que le df initial (les mêmes individus)</span>
<span class="sd">                    - en colonnes les variables illustratives quantitatives</span>

<span class="sd">            varSuppQual (DataFrame): variables illustratives qualitatives</span>

<span class="sd">                - valeur acceptée : df avec</span>

<span class="sd">                    - même nb de lignes que le df initial (les mêmes individus)</span>
<span class="sd">                    - en colonnes les variables illustratives qualitatives</span>

<span class="sd">            labels (boolean): affichage des valeurs de la variable des observations (variable en index)</span>

<span class="sd">                - valeur acceptée : True or None</span>
<span class="sd">                - NB : si labels = True, alors labels_ind = False  (ne choisir que 1 de ces 2 possibilités)</span>

<span class="sd">            labels_ind (boolean): affichage de l&#39;indice des valeurs de la variable des observations (variable en index)</span>

<span class="sd">                - valeur acceptée : True or None</span>
<span class="sd">                - NB : si labels_ind = True, alors labels = False  (ne choisir que 1 de ces 2 possibilités)</span>
<span class="sd">                - intérêt de cette option: facilite la lecture du graphique &quot;Projection des individus&quot;, notamment si le</span>
<span class="sd">                nombre d&#39;oservations (nombre de lignes) est important</span>

<span class="sd">            legend_label (boolean): affichage des correspondances indice et valeur de la variable d&#39;observation (valable ssi labels_ind=True)</span>

<span class="sd">                - valeur acceptée : True or None</span>
<span class="sd">                - si True, une légende de correspondance entre index affiché sur le graphique et valeur réelle de la </span>
<span class="sd">                variable d&#39;observationb (en index) sera affichée sous le graphique</span>

<span class="sd">            version_name (str): prefixer les graphiques par un nom particulier</span>

<span class="sd">                - valeur acceptée : string qui prefixera le nom des graphiques </span>

<span class="sd">                        ex : si version_name = &quot;test1&quot; alors le graphique &quot;Eboulis des valeurs propres se nommera </span>
<span class="sd">                        &quot;test1_recherche_nb_facteurs_optimal.png&quot;</span>

<span class="sd">                - intérêt: enregistrer tous les graphiques de différentes versions d&#39;une même ACP</span>

<span class="sd">            graph_only (boolean): afficher seulement les graphiques (cercle de corrélation et projection des individus)</span>

<span class="sd">                - valeur acceptée : True or None</span>

<span class="sd">            data_only (boolean): ne rien renvoyer lors de l&#39;appel de la fonction</span>

<span class="sd">                - valeur acceptée : True or None</span>
<span class="sd">                - pour print un élément en particulier:</span>
<span class="sd">                    * donner un nom à la fonction lors de l&#39;appel</span>
<span class="sd">                        ex : resultat_acp = acp_perso(df, data_only=True)</span>
<span class="sd">                    * faire print(*resultat_acp)</span>

<span class="sd">            color_titles (list): liste de 3 couleurs au format hexadécimale (ex &quot;#FFFFFF&quot;) pour les titres h2, h3, h4</span>

<span class="sd">                - couleurs des titres par défaut : [&quot;#b08c20&quot;, &quot;#3aa237&quot;, &quot;#29858a&quot;]</span>

<span class="sd">            palette_color (list): liste de couleurs au format hexadécimale (ex &quot;#FFFFFF&quot;)pour les graphiques de l&#39;ACP</span>

<span class="sd">                - couleurs par défaut : [&quot;#b30f1c&quot;, &quot;#0e6667&quot;, &quot;#3353e1&quot;, &quot;#4ed147&quot;, &quot;#d17e1a&quot;, &quot;#2bb6b6&quot;,</span>
<span class="sd">                &quot;#514a39&quot;, &quot;#4ed147&quot;, &quot;#acb073&quot;, &quot;#8b3afd&quot;, &quot;#dec11b&quot;, &quot;#58f3e6&quot;, &quot;#728e9d&quot;]</span>

<span class="sd">        Returns:</span>

<span class="sd">            val_centre_reduit (DataFrame): df centré-réduit</span>
<span class="sd">            valeurs_propres (list): valeurs propres</span>
<span class="sd">            pct_inertie_par_facteur           (list): pourcentage d&#39;inertie par facteur</span>
<span class="sd">            nb_groupes_opt                    (str): path du graph &quot;Eboulis des valeurs propres&quot;</span>
<span class="sd">            test_batons_brises                (DataFrame): df valeurs propres / valeurs de seuil par facteur</span>
<span class="sd">            coord_fact_ind                    (DataFrame): coordonnées factorielles des individus</span>
<span class="sd">            cos2_ind                          (DataFrame): cos² des individus pour chaque axe factoriel</span>
<span class="sd">            contribution_ind                  (DataFrame): df globale: contribution des individus aux axes</span>
<span class="sd">            ctr_ind_sorted_facteur_i          (DataFrame): df par facteur: les plus gros contributeurs à l&#39;axe i</span>

<span class="sd">                - pour tous les facteurs i</span>

<span class="sd">            vecteurs_propres                  (DataFrame): vecteurs propres des variables par facteur</span>
<span class="sd">            matrice_cor                       (array): matrice des corrélations des variables par facteur</span>
<span class="sd">            cor_par_facteur                   (DataFrame): df de la matrice des corrélations                 </span>
<span class="sd">            cos2_var                          (DataFrame): cos² des variables par axe factoriel</span>
<span class="sd">            contribution_var                  (DataFrame): contribution des variables aux axes              </span>
<span class="sd">            cor_par_facteur_VarQttiveIllus    (DataFrame): corrélations des variables quantitatives illustratives par axe</span>
<span class="sd">            resultats_tests                   (list): résultats des différents tests interes (1 if ok else 0)</span>
<span class="sd">            centroides_a_b                    (array): si clusters ou variable qualitative illustrative: coordonnées des centroïdes</span>

<span class="sd">                - pour chaque plan factoriel [a,b]</span>

<span class="sd">            graph_proj_ind_a_b                (str): path du graph de projection des individus</span>

<span class="sd">                - pour chaque plan factoriel [a,b]</span>

<span class="sd">            cercle_cor_a_b                    (str): path du graph du cercle des corrélations</span>

<span class="sd">                - pour chaque plan factoriel [a,b]</span>

<span class="sd">            graph_combo_a_b                   (str): path du graph composé (cf. les 2 graphs précédents)</span>

<span class="sd">                - pour chaque plan factoriel [a,b]</span>

<span class="sd">            select_obs                        (dict): dictionnaire :</span>

<span class="sd">                * key:</span>
<span class="sd">                    - si labels=True        alors valeurs de la variable d&#39;observation</span>
<span class="sd">                    - si labels_ind = True  alors index des valeurs de la variable d&#39;observation</span>

<span class="sd">                * value:</span>
<span class="sd">                    - tuple composé de 2 df:</span>
<span class="sd">                        - df données initiales de l&#39;observation</span>
<span class="sd">                        - df données calculées pour cette observation</span>
<span class="sd">                            - ses coordonnées factorielles</span>
<span class="sd">                            - sa qualité de représentation sur les différents axes (cf. COS²)</span>
<span class="sd">                            - sa contribution aux différents axes</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nombre de combinaisons sans répétition de k objets pris parmi n&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">//</span> <span class="n">y</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">x</span>


    <span class="k">def</span> <span class="nf">choix_coord</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calcul des valeurs absolues des coordonnées pour définir xlim et ylim du graph de projection des individus&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lim</span>


    <span class="k">def</span> <span class="nf">multi_table</span><span class="p">(</span><span class="n">table_list</span><span class="p">,</span> <span class="n">marg_r</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Afficher des df côte à côte&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span>
            <span class="s1">&#39;&lt;table&gt;&lt;tr style=&quot;text-align:right;&quot;&gt;&#39;</span>
            <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;&lt;td &quot;</span>
                    <span class="o">+</span> <span class="p">(</span>
                        <span class="s1">&#39; style=&quot;text-align:right;padding-right:&#39;</span>
                        <span class="o">+</span> <span class="n">marg_r</span>
                        <span class="o">+</span> <span class="s1">&#39;rem!important;&quot;&#39;</span>
                        <span class="k">if</span> <span class="n">marg_r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                    <span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span>
                    <span class="o">+</span> <span class="n">table</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()</span>
                    <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span>
                    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">table_list</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/table&gt;&quot;</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">alert_verif</span><span class="p">(</span><span class="n">fail</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">valid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Afficher alertes error ou success des tests lors de l&#39;ACP&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">valid</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span>
                <span class="n">HTML</span><span class="p">(</span>
                    <span class="s1">&#39;&lt;div class=&quot;alert alert-block alert-danger&quot; style=&quot;width:fit-content; margin:8px auto 8px 0; border-radius:5px; padding:7px 50px 7px 15px;&quot;&gt;&#39;</span>
                    <span class="o">+</span> <span class="n">fail</span>
                    <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span>
                <span class="n">HTML</span><span class="p">(</span>
                    <span class="s1">&#39;&lt;div class=&quot;alert alert-block alert-success&quot; style=&quot;width:fit-content; margin:8px auto 8px 0; border-radius:5px; padding:7px 50px 7px 15px;&quot;&gt;&#39;</span>
                    <span class="o">+</span> <span class="n">success</span>
                    <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>


    <span class="k">def</span> <span class="nf">dic_modalite</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Si modalités de colonne groupe ne sont pas de type integer =&gt; ajout d&#39;une colonne avec correspondance modalité &lt;=&gt; integer&quot;&quot;&quot;</span>
        <span class="n">modalites</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">modalites</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">modalites</span><span class="p">)</span>
        <span class="n">dic_mod</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modalites</span><span class="p">)):</span>
            <span class="n">dic_mod</span><span class="p">[</span><span class="n">modalites</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;i_&quot;</span> <span class="o">+</span> <span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dic_mod</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i_&quot;</span> <span class="o">+</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="p">})</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">df</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">dic_mod</span><span class="p">]</span>


    <span class="c1"># test cohérence des paramètres</span>
    <span class="n">msg_array</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">msg_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ATTENTION: les paramètres &#39;labels&#39; et &#39;labels_int&#39; avaient pour valeur None.&lt;br&gt;&quot;</span><span class="o">+</span>
        <span class="s2">&quot;Afin de pouvoir exécuter la fonction, la valeur de &#39;labels&#39; a été passée à True&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels_ind</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">msg_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ATTENTION: les paramètres &#39;labels&#39; et &#39;labels_int&#39; avaient pour valeur True.&lt;br&gt;&quot;</span><span class="o">+</span>
        <span class="s2">&quot;Afin de pouvoir exécuter la fonction, la valeur de &#39;labels_ind&#39; a été passée à None&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">legend_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_label</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">msg_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ATTENTION: incompatibilité entre &#39;labels_ind&#39; = None et legend_label != None.&lt;br&gt;&quot;</span><span class="o">+</span>
        <span class="s2">&quot;Afin de pouvoir exécuter la fonction, la valeur de &#39;legend_label&#39; a été passée à None&quot;</span><span class="p">)</span>


    <span class="c1"># Création du dossier de sauvegarde des graphs</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;apc_graphs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Gestion des couleurs des fonts</span>
    <span class="n">cc_titles</span> <span class="o">=</span> <span class="n">color_titles</span> <span class="k">if</span> <span class="n">color_titles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;#b08c20&quot;</span><span class="p">,</span> <span class="s2">&quot;#3aa237&quot;</span><span class="p">,</span> <span class="s2">&quot;#29858a&quot;</span><span class="p">]</span>
    <span class="n">h2s</span> <span class="o">=</span> <span class="s2">&quot;color:&quot;</span><span class="o">+</span><span class="n">cc_titles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!important;padding-left:.5rem!important;line-height:150%!important;&quot;</span>
    <span class="n">h3s</span> <span class="o">=</span> <span class="s2">&quot;color:&quot;</span><span class="o">+</span><span class="n">cc_titles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!important;padding-left:1rem !important;line-height:150%!important;font-size:120%!important;&quot;</span>
    <span class="n">h4s</span> <span class="o">=</span> <span class="s2">&quot;color:&quot;</span><span class="o">+</span><span class="n">cc_titles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!important;padding-left:2rem !important;font-size:110% !important;&quot;</span>

    <span class="k">if</span> <span class="n">palette_color</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">palette_perso</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;#b30f1c&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#0e6667&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#3353e1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#4ed147&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#d17e1a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#2bb6b6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#514a39&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#4ed147&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#acb073&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#8b3afd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#dec11b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#58f3e6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#728e9d&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">palette_perso</span> <span class="o">=</span> <span class="n">palette_color</span>

    <span class="c1"># Afficher 4 décimales pour les floats</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span>

    <span class="c1"># Si data_only, alors on n&#39;affiche rien</span>
    <span class="k">if</span> <span class="n">data_only</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">graph_only</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">############################</span>
    <span class="c1"># Préparation des données</span>
    <span class="c1">############################</span>

    <span class="c1"># initialisation de variables</span>
    <span class="n">all_values</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">df_liste</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">df_liste_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resultats_test</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># creation d&#39;un df_global avec toutes les variables (actives + illus quant + illus qual)</span>
    <span class="n">df_liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df_liste_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">varSupp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varSupp</span><span class="p">)</span>
        <span class="n">df_liste_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varSupp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">varSuppQual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varSuppQual</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_c</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df_c</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
    <span class="n">df_global_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_liste_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ind_spe</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">group_special</span><span class="p">)]</span>

    <span class="c1"># df pour l&#39;ACP</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span>
    <span class="c1"># Nombre d&#39;individus</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Nombres de Variables</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># instanciation ACP normée</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="c1"># transformation</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="c1"># moyenne</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># ecart-type</span>
    <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># df centré-réduit</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x1</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>

    <span class="c1"># df enregistré dans notre dictionnaire qui sera return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;val_centre_reduit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1</span>

    <span class="c1"># Nombre de dimensions à étudier</span>
    <span class="n">n_comp</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">dd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">nb_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_ranks</span><span class="p">)</span>
    <span class="n">max_combi</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_comp</span><span class="p">)</span>

    <span class="c1"># message d&#39;erreur possible</span>
    <span class="k">if</span> <span class="n">nb_dim</span> <span class="o">&gt;</span> <span class="n">max_combi</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Vous avez indiqué un nombre trop important de plan factoriels. Il y en a </span><span class="si">{</span><span class="n">max_combi</span><span class="si">}</span><span class="s2"> de possibles au maximum (votre requête a été modifiée en ce sens.)&quot;</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">axis_ranks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">&gt;</span> <span class="n">n_comp</span> <span class="ow">or</span> <span class="n">d2</span> <span class="o">&gt;</span> <span class="n">n_comp</span> <span class="ow">or</span> <span class="n">n_comp</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;Il y a un problème avec les dimensions que vous avez saisis, merci de vérifier les variables &quot;axis_ranks&quot; et &quot;n_comp&quot;&#39;</span>
            <span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d1</span> <span class="o">&gt;</span> <span class="n">d2</span><span class="p">:</span>
                <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d1</span>

    <span class="c1">############################################################################</span>
    <span class="c1">#                      Analyse en composantes principale                   #</span>
    <span class="c1">############################################################################</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">#       1. Informations sur les données</span>
    <span class="c1">###########################################################################</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h2 style=&quot;</span> <span class="o">+</span> <span class="n">h2s</span> <span class="o">+</span> <span class="s2">&quot;&gt;Analyse en composantes principales&lt;/h2&gt;&quot;</span><span class="p">))</span>

        <span class="c1"># si problème de cohérence dans les paramètres =&gt; message d&#39;alerte</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg_coherence_fail</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg_array</span><span class="p">)</span>
            <span class="n">alert_verif</span><span class="p">(</span>
                <span class="n">fail</span><span class="o">=</span><span class="n">msg_coherence_fail</span><span class="p">,</span>
                <span class="n">success</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="c1"># affichage d&#39;infos générales sur les données initiales</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3 style=&quot;</span> <span class="o">+</span> <span class="n">h3s</span> <span class="o">+</span> <span class="s2">&quot;&gt;1. Informations sur les données&lt;/h3&gt;&quot;</span><span class="p">))</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h4 style=&quot;</span> <span class="o">+</span> <span class="n">h4s</span> <span class="o">+</span> <span class="s2">&quot;&gt;1.1 Données initiales&lt;/h4&gt;&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nombre d&#39;individus : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nombre de variables : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>


    <span class="c1">######### Instanciation et lancement des calculs</span>

    <span class="c1"># instanciation des classes</span>
    <span class="n">acp</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">svd_solver</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">)</span>

    <span class="c1">#########################################</span>
    <span class="c1"># calculs des coordonnées factorielles</span>
    <span class="c1">#########################################</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">acp</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

    <span class="c1">#########################################</span>
    <span class="c1"># calculs des valeurs propres</span>
    <span class="c1">#########################################</span>
    <span class="c1"># valeur corrigée</span>
    <span class="n">eigval</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_</span>

    <span class="c1"># valeurs propres enregistrées pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;valeurs_propres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigval</span>

    <span class="c1"># pourcentage d&#39;inertie par facteur pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;pct_inertie_par_facteur&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
    <span class="c1"># infos sur les données centrées-réduites</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;Variables&quot;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;Moyennes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;Ecarts_types&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;Var_Exp&quot;</span><span class="p">:</span> <span class="n">eigval</span><span class="p">,</span>
            <span class="s2">&quot;Prop_Var_Exp&quot;</span><span class="p">:</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">x1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h4 style=&quot;</span> <span class="o">+</span> <span class="n">h4s</span> <span class="o">+</span> <span class="s2">&quot;&gt;1.2 Données centrées réduites&lt;/h4&gt;&quot;</span><span class="p">))</span>
        <span class="c1"># nombre de composantes calculées</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nombre de composantes calculées : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">acp</span><span class="o">.</span><span class="n">n_components_</span><span class="p">))</span>
        <span class="c1"># affichage d&#39;infos sur les données centrées-réduites</span>
        <span class="n">display</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

    <span class="c1"># vérification que valeurs propres = p</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">vp_test</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">Var_Exp</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">vp_test</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="ow">or</span> <span class="n">vp_test</span> <span class="o">&gt;</span> <span class="n">p</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alert_verif</span><span class="p">(</span>
            <span class="n">fail</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des valeurs propres égale au nombre de variables actives a échoué&quot;</span><span class="p">,</span>
            <span class="n">success</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des valeurs propres égale au nombre de variables s&#39;est correctement déroulée&quot;</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="n">valid</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1">###########################################################################</span>
        <span class="c1">#       2. Recherche du nombre de facteurs à retenir</span>
        <span class="c1">###########################################################################</span>

        <span class="n">display</span><span class="p">(</span>
            <span class="n">HTML</span><span class="p">(</span>
                <span class="s2">&quot;&lt;h3 style=&quot;</span>
                <span class="o">+</span> <span class="n">h3s</span>
                <span class="o">+</span> <span class="s2">&quot;&gt;2. Recherche du nombre de facteurs à retenir&lt;/h3&gt;&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1">###################################################</span>
    <span class="c1"># graphique d&#39;Eboulis des valeurs propres</span>
    <span class="c1">###################################################</span>

    <span class="c1"># initialisation de la figure</span>
    <span class="k">if</span> <span class="n">graph_only_acp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">nb_gr_op</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">),</span>
            <span class="s2">&quot;o-&quot;</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span>
            <span class="n">mfc</span><span class="o">=</span><span class="s2">&quot;tomato&quot;</span><span class="p">,</span>
            <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;tomato&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Eboulis des valeurs propres&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pourcentage d&#39;inertie&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Rang de l&#39;axe d&#39;inertie&quot;</span><span class="p">)</span>
        <span class="n">y_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)):</span>
            <span class="n">y_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">y_pos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># affichage du pourcentage cumulé de variance expliquée</span>
        <span class="n">part_inertie</span> <span class="o">=</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">texte</span> <span class="o">=</span> <span class="s2">&quot;Variance Cumulée  :  &quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">part_inertie</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">part_inertie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">part_inertie</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">texte</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;%,  &quot;</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">20</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">texte</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">texte</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">texte</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">nb_groupes_opt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;apc_graphs/&quot;</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;recherche_nb_facteurs_optimal&quot;</span>
        <span class="p">)</span>
        <span class="n">nb_gr_op</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nb_groupes_opt</span><span class="p">)</span>
        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;nb_groupes_opt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb_groupes_opt</span>

        <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">nb_gr_op</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Détermination du nombre de facteurs à retenir</span>
    <span class="c1">################################################</span>

    <span class="c1"># proportion de variance expliquée</span>
    <span class="n">part_var_exp</span> <span class="o">=</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>

    <span class="c1"># seuils pour test des bâtons brisés</span>
    <span class="n">bs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
    <span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># test des bâtons brisés</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Val.Propre&quot;</span><span class="p">:</span> <span class="n">eigval</span><span class="p">,</span> <span class="s2">&quot;Seuils&quot;</span><span class="p">:</span> <span class="n">bs</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bb</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="s2">&quot;Val.Propre&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="s2">&quot;Seuils&quot;</span><span class="p">]:</span>
            <span class="k">break</span>

    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;test_batons_brises&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb</span>

    <span class="c1"># coordonnées factorielles des individus</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
        <span class="s2">&quot;|     Proportion de variance expliquée     |</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
        <span class="s2">&quot;--------------------------------------------&quot;</span><span class="p">)</span>

        <span class="n">df_var_e</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">part_var_exp</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
        <span class="n">df_var_e</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Facteurs&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_var_e</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">df_var_e</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s2">&quot;Facteurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;le 1er facteur&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_var_e</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="s2">&quot;Facteurs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;les &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; 1ers facteurs&quot;</span>
        <span class="n">df_var_e</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Facteurs&quot;</span><span class="p">,</span> <span class="s2">&quot;part_var&quot;</span><span class="p">]</span>

        <span class="n">nb_f_var_e</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">pp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;part_var&quot;</span><span class="p">])):</span>
            <span class="k">if</span> <span class="n">pp</span> <span class="o">&gt;=</span> <span class="mf">0.8</span><span class="p">:</span>
                <span class="n">nb_f_var_e</span> <span class="o">=</span> <span class="n">jj</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">break</span>

        <span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;Part variance expliquée&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;part_var&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;Part variance expliquée&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;Part variance expliquée&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;Part variance expliquée&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_var_e</span><span class="p">[</span><span class="s2">&quot;Part variance expliquée&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
        <span class="n">df_var_e</span> <span class="o">=</span> <span class="n">df_var_e</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;part_var&#39;</span><span class="p">])</span>
        <span class="n">display</span><span class="p">(</span><span class="n">df_var_e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Si on recherche à expliquer au minimum 80</span><span class="si">% d</span><span class="s2">e la variance, il faut retenir &quot;</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="s2">&quot;uniquement le 1er facteur.&quot;</span>
                <span class="k">if</span> <span class="n">nb_f_var_e</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="k">else</span> <span class="s2">&quot;les &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nb_f_var_e</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; 1ers facteurs.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|     Test des bâtons brisés     |&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----------------------------------&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Selon le </span><span class="se">\&quot;</span><span class="s2">test des bâtons brisés</span><span class="se">\&quot;</span><span class="s2">, &quot;</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="s2">&quot;seul le premier facteur est valide&quot;</span>
                <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">0</span>
                <span class="k">else</span> <span class="s2">&quot;les &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; premiers facteurs sont valides&quot;</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; (car pour le facteur &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;, la valeur du seuil est supérieure à la valeur propre).&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------------&quot;</span><span class="p">)</span>

        <span class="n">eigval_ok</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eigval</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">len_v_ok</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval_ok</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Autre interprétation possible : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;plus la valeur propre initiale est élevée, plus le facteur explique une portion significative de la variance totale.&quot;</span><span class="o">+</span>
            <span class="s2">&quot;Par convention, tout facteur avec une valeur propre initiale supérieure à 1 est considéré comme facteur significatif.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Ainsi, selon cette interprétation, &quot;</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="s2">&quot;seul le premier facteur est valide.&quot;</span>
                <span class="k">if</span> <span class="n">len_v_ok</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="k">else</span> <span class="s2">&quot;les &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">len_v_ok</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; premiers facteurs sont valides.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nb_f_var_e</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">len_v_ok</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Remarque : &lt;br&gt;Selon certaines procédures, il faudrait limiter le nombre de facteurs à retenir à 1.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;Mais pour pouvoir effectuer cette analyse, nous étudierons au minimumm 2 facteurs.&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="c1">###########################################################################</span>
        <span class="c1">#       3. Représentation des individus</span>
        <span class="c1">###########################################################################</span>

        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3 style=&quot;</span> <span class="o">+</span> <span class="n">h3s</span> <span class="o">+</span> <span class="s2">&quot;&gt;3. Représentation des individus&lt;/h3&gt;&quot;</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####               Coordonnées factorielles des individus                   ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;On affiche les coordonnées factorielles de 3 individus (random)&quot;</span><span class="p">)</span>
        <span class="n">cff</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">old_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cff</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">old_cols</span><span class="p">]</span>
        <span class="n">cff</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_cols</span>
        <span class="n">display</span><span class="p">(</span><span class="n">cff</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="c1"># coord. factorielles des individus enregistrées pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;coord_fact_ind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cff</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####             Qualité de la représentation des individus                 ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

    <span class="n">di</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;d_i&quot;</span><span class="p">:</span> <span class="n">di</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;La qualité de représentation des individus sur les axes du plan factoriel.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;Il s&#39;agit de calculer le COS² de chaque individu pour chaque axe.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;On affiche un random sur 3 individus de la mesure des COS²&quot;</span>
        <span class="p">)</span>

    <span class="c1"># calcul des cos² des individus</span>
    <span class="n">cos2</span> <span class="o">=</span> <span class="n">coord</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">cos2_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">cos2_ind</span><span class="p">[</span><span class="s2">&quot;COS²_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cos2</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">di</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">cos2_ind</span><span class="p">[</span><span class="s2">&quot;COS²_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cos2_ind</span><span class="p">[</span><span class="s2">&quot;COS²_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">cos2_ind</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="c1"># cos² des individus enregistrés pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;cos2_ind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cos2_ind</span>

    <span class="c1"># vérifions la théorie - somme en ligne des cos2 = 1</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">cos2_ind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
    <span class="n">somme</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">somme</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">somme</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.95</span> <span class="ow">or</span> <span class="n">somme</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">valid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alert_verif</span><span class="p">(</span>
            <span class="n">fail</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des COS² égale à 1 pour tous les individus a echoué&quot;</span><span class="p">,</span>
            <span class="n">success</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des COS² égale à 1 pour tous les individus s&#39;est correctement déroulée&quot;</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="n">valid</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="c1"># Contributions des individus aux axes</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####                  Contributions des individus aux axes                  ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Elles permettent de déterminer les individus qui pèsent le plus dans la définition de chaque facteur.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;On regarde quels sont les individus qui sont les plus contributifs et ce, pour les différents axes.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;Pour chaque axe, on affiche les 10 individus qui contribuent le plus.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># calcul des contributions des individus aux axes</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="n">coord</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">ctr_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ind&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">ctr_ind</span><span class="p">[</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ctr</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">eigval</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">ctr_ind</span><span class="p">[</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">ctr_ind</span><span class="p">[</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>

    <span class="c1"># contribution des individus enregistrées pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;contribution_ind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctr_ind</span>

    <span class="c1"># préparation de l&#39;affichage des plus gros contributeurs par axe</span>
    <span class="n">ctr_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ctr_list_aff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rang_liste</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">ctr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ctr_ind</span><span class="p">[[</span><span class="s2">&quot;ind&quot;</span><span class="p">,</span> <span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
                <span class="n">by</span><span class="o">=</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">ctr_list_aff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctr_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">ctr_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s2">&quot;rang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rang_liste</span>
        <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s2">&quot;CTR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span>
        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;ctr_ind_sorted_facteur_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">len_multi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ctr_list_aff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">len_multi</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">reste</span> <span class="o">=</span> <span class="n">len_multi</span> <span class="o">%</span> <span class="mi">4</span>
            <span class="n">nb_multi</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">len_multi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">reste</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">len_multi</span> <span class="o">/</span> <span class="mi">4</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_multi</span><span class="p">):</span>
                <span class="n">ar</span> <span class="o">=</span> <span class="n">ctr_list_aff</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">display</span><span class="p">(</span><span class="n">multi_table</span><span class="p">(</span><span class="n">ar</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">multi_table</span><span class="p">(</span><span class="n">ctr_list_aff</span><span class="p">))</span>

    <span class="c1"># vérifions la théorie - somme en colonnes = 1</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">ctr_ind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;ind&quot;</span><span class="p">)</span>
    <span class="n">somme</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">somme</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">somme</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.95</span> <span class="ow">or</span> <span class="n">somme</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">valid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alert_verif</span><span class="p">(</span>
            <span class="n">fail</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des contributeurs égale à 1 pour tous les axes factoriels a échoué&quot;</span><span class="p">,</span>
            <span class="n">success</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des contributeurs égale à 1 pour tous les axes factoriels s&#39;est correctement déroulée&quot;</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="n">valid</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="c1">###########################################################################</span>
        <span class="c1">#       4. Représentation des variables</span>
        <span class="c1">###########################################################################</span>

        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3 style=&quot;</span> <span class="o">+</span> <span class="n">h3s</span> <span class="o">+</span> <span class="s2">&quot;&gt;4. Représentation des variables&lt;/h3&gt;&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Le champ components_ de l&#39;objet ACP correspond aux valeurs propres.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;On peut alors calculer la matrice des corrélations variables * facteurs&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># calcul des vecteurs propres</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="n">acp</span><span class="o">.</span><span class="n">components_</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x1</span><span class="p">[</span><span class="s2">&quot;F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">x1</span><span class="p">[</span><span class="s2">&quot;F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s2">&quot;F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>

    <span class="c1"># vecteurs propres enregistrées pour le return</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;vecteurs_propres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1</span>

    <span class="c1"># racine carrée des valeurs propres</span>
    <span class="n">sqrt_eigval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>

    <span class="c1"># corrélation des variables avec les axes</span>
    <span class="n">corvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">corvar</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">acp</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">sqrt_eigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="c1"># afficher la matrice des corrélations variables x facteurs</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">corvar</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;matrice_cor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span>

    <span class="n">x3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x3</span><span class="p">[</span><span class="s2">&quot;COR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">corvar</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">x3</span><span class="p">[</span><span class="s2">&quot;COR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x3</span><span class="p">[</span><span class="s2">&quot;COR_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;cor_par_facteur&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x3</span>

    <span class="c1"># Qualité de représentation des variables : COS²</span>
    <span class="n">cos2var</span> <span class="o">=</span> <span class="n">corvar</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="s2">&quot;COS²_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cos2var</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">x</span><span class="p">[</span><span class="s2">&quot;COS²_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;COS²_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;cos2_var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####                            Les vecteurs propres                            ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####                          Corrélations par facteur                          ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####                             COS² des variables                             ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># vérifions la théorie - somme COS² en lignes = 1</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cos2var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.95</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">valid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alert_verif</span><span class="p">(</span>
            <span class="n">fail</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des COS² égale à 1 pour tous les facteurs a échoué&quot;</span><span class="p">,</span>
            <span class="n">success</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des COS² égale à 1 pour tous les facteur s&#39;est correctement déroulée&quot;</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="n">valid</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># contributions</span>
    <span class="n">ctrvar</span> <span class="o">=</span> <span class="n">cos2var</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">ctrvar</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctrvar</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">eigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">x4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x4</span><span class="p">[</span><span class="s2">&quot;CTR_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ctrvar</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">x4</span><span class="p">[</span><span class="s2">&quot;CTR_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x4</span><span class="p">[</span><span class="s2">&quot;CTR_var_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;contribution_var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x4</span>
    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####                        Contribution des variables                          ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
            <span class="s2">&quot;####################################################################################&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;La contribution est également basée sur le carré de la corrélation, mais relativisée par l’importance de l’axe.&quot;</span>

        <span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">x4</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">cols_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x4</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
        <span class="n">x4</span> <span class="o">=</span> <span class="n">x4</span><span class="p">[</span><span class="n">cols_str</span><span class="p">]</span>
        <span class="n">display</span><span class="p">(</span><span class="n">x4</span><span class="p">)</span>

    <span class="c1"># vérifions la théorie - somme en colonnes = 1</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cos2var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.95</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.05</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">valid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultats_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alert_verif</span><span class="p">(</span>
            <span class="n">fail</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des contributeurs égale à 1 pour tous les axes factoriels a échoué&quot;</span><span class="p">,</span>
            <span class="n">success</span><span class="o">=</span><span class="s2">&quot;La vérifiction de la somme des contributeurs égale à 1 pour tous les axes factoriels s&#39;est correctement déroulée&quot;</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="n">valid</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="c1">###########################################################################</span>
        <span class="c1">#       5. Traitement des variables supplémentaires</span>
        <span class="c1">###########################################################################</span>

        <span class="c1"># Traitement des variables supplémentaires</span>
        <span class="n">display</span><span class="p">(</span>
            <span class="n">HTML</span><span class="p">(</span>
                <span class="s2">&quot;&lt;h3 style=&quot;</span> <span class="o">+</span> <span class="n">h3s</span> <span class="o">+</span> <span class="s2">&quot;&gt;5. Traitement des variables supplémentaires&lt;/h3&gt;&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># variables supplémentaires quantitatives</span>
    <span class="k">if</span> <span class="n">varSupp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
                <span class="s2">&quot;####                   Variables illustratives quantitatives                    ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
                <span class="s2">&quot;####################################################################################&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="c1"># corrélation avec les axes factoriels</span>
        <span class="n">vsQuanti</span> <span class="o">=</span> <span class="n">varSupp</span><span class="o">.</span><span class="n">values</span>
        <span class="n">corSupp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">varSupp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">))</span>

        <span class="c1"># rappel: p est le nombre total de dimensions générées</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">varSupp</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vsQuanti</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">vsQuanti</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">coord</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="s2">&quot;COR_VQI_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">corSupp</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
            <span class="n">x</span><span class="p">[</span><span class="s2">&quot;COR_VQI_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
                <span class="n">x</span><span class="p">[</span><span class="s2">&quot;COR_VQI_F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">4</span>
            <span class="p">)</span>
        <span class="c1"># affichage des corrélations avec les axes</span>
        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;cor_par_facteur_VarQttiveIllus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

        <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|       Corrélations avec les axes factoriels         |&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># variables supplémentaires qualitatives</span>
    <span class="n">vars_qual</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">varSuppQual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;####################################################################################</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
                <span class="s2">&quot;####                    Variables illustratives qualitatives                    ####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span>
                <span class="s2">&quot;####################################################################################&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Principe : on utilise la variable qualitative pour différencier les individus en fonction des modalités de celle-ci.&quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Etant donné qu&#39;il existe déjà différents clusters dans ce jeu de données, un graphique supplémentaire sera réalisé, &quot;</span><span class="o">+</span>
                    <span class="s2">&quot;à savoir une projection des individus avec des groupes correspondants aux différentes modalités de la &quot;</span><span class="o">+</span>
                    <span class="s2">&quot;variable qualitative (en faisant abstraction des clusters).&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Le jeu de données ne disposant pas de classification des individus, les modalités de la &quot;</span><span class="o">+</span>
                    <span class="s2">&quot;variable qualitative seront utilisées pour différencier les individus &quot;</span><span class="o">+</span>
                    <span class="s2">&quot;dans le graphique de projection.&quot;</span>
                <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

            <span class="n">vars_qual</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">varSuppQual</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">len_varq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vars_qual</span><span class="p">)</span>
            <span class="n">pluriel</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">len_varq</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">len_varq</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; variable&quot;</span> <span class="o">+</span><span class="n">pluriel</span><span class="o">+</span> <span class="s2">&quot; illustrative&quot;</span> <span class="o">+</span><span class="n">pluriel</span><span class="o">+</span> <span class="s2">&quot; qualitative&quot;</span> <span class="o">+</span><span class="n">pluriel</span><span class="o">+</span> <span class="s2">&quot; :&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vqual</span> <span class="ow">in</span> <span class="n">vars_qual</span><span class="p">:</span>
                <span class="n">name_vqual</span> <span class="o">=</span> <span class="s2">&quot;Variable &quot;</span> <span class="o">+</span> <span class="n">vqual</span>
                <span class="n">modalites</span> <span class="o">=</span> <span class="n">varSuppQual</span><span class="p">[</span><span class="n">vqual</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">modalites</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">modalites</span><span class="p">)</span>
                <span class="n">len_modalites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">modalites</span><span class="p">)</span>
                <span class="n">mod_str</span> <span class="o">=</span> <span class="s1">&#39;&quot;, &quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">modalites</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     ▪ Variable &quot;</span> <span class="o">+</span> <span class="n">vqual</span> <span class="o">+</span> <span class="s2">&quot; =&gt; &quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">len_modalites</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; modalités : [&quot;&#39;</span><span class="o">+</span> <span class="n">mod_str</span> <span class="o">+</span> <span class="s1">&#39;&quot;]&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>

    <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;resultats_tests&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultats_test</span>

    <span class="c1">###########################################################################</span>
    <span class="c1">#       6. Représentation graphique</span>
    <span class="c1">###########################################################################</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Représentation graphique</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3 style=&quot;</span> <span class="o">+</span> <span class="n">h3s</span> <span class="o">+</span> <span class="s2">&quot;&gt;6. Représentation graphique&lt;/h3&gt;&quot;</span><span class="p">))</span>

    <span class="c1"># Projection des individus</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels_ind</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Nombre de dimensions à étudier</span>
    <span class="n">n_comp</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">nb_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_ranks</span><span class="p">)</span>
    <span class="n">max_combi</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_comp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nb_dim</span> <span class="o">&gt;</span> <span class="n">max_combi</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Vous avez indiqué un nombre trop important de plan factoriels. &quot;</span><span class="o">+</span>
            <span class="s2">&quot;Il y en a </span><span class="si">{max_combi}</span><span class="s2"> de possibles au maximum (votre requête a été modifiée en ce sens.)&quot;</span>
        <span class="p">)</span>

    <span class="c1">## Détermination du nombre de classifications total</span>
    <span class="n">all_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">varSuppQual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># test integer</span>
            <span class="n">test_group_int</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">modalites</span> <span class="o">=</span> <span class="n">df_c</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">df_c</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">test_group_int</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">test_group_int</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">all_groups</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_c</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="p">{}])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ar</span> <span class="o">=</span> <span class="n">dic_modalite</span><span class="p">(</span><span class="n">df_c</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">all_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">varSuppQual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
            <span class="n">varSuppQual</span> <span class="o">=</span> <span class="n">varSuppQual</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">vqual</span> <span class="ow">in</span> <span class="n">vars_qual</span><span class="p">:</span>
                <span class="n">df_q</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_q</span><span class="p">[</span><span class="n">vqual</span><span class="p">]</span> <span class="o">=</span> <span class="n">varSuppQual</span><span class="p">[</span><span class="n">vqual</span><span class="p">]</span>
                <span class="n">ar</span> <span class="o">=</span> <span class="n">dic_modalite</span><span class="p">(</span><span class="n">df_q</span><span class="p">,</span> <span class="n">vqual</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">all_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
    <span class="n">nb_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_groups</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_groups</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nb_groups</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;  7.&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;. Individus différenciés en fonction de la variable &quot;</span>
                <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">axis_ranks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">&gt;</span> <span class="n">n_comp</span> <span class="ow">or</span> <span class="n">d2</span> <span class="o">&gt;</span> <span class="n">n_comp</span> <span class="ow">or</span> <span class="n">n_comp</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s1">&#39;Il y a un problème avec les dimensions que vous avez saisis, merci de vérifier les variables &quot;axis_ranks&quot; et &quot;n_comp&quot;&#39;</span>
                <span class="p">)</span>
                <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d1</span> <span class="o">&gt;</span> <span class="n">d2</span><span class="p">:</span>
                    <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d1</span>
                <span class="k">if</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="n">n_comp</span><span class="p">:</span>

                    <span class="n">x_min</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">x_max</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">y_min</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">y_max</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="n">xlim</span> <span class="o">=</span> <span class="n">choix_coord</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
                    <span class="n">ylim</span> <span class="o">=</span> <span class="n">choix_coord</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>

                    <span class="c1"># array des texts sur graphiques pour appliquer module adjust_text</span>
                    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="c1"># initialisation de la figure</span>
                    <span class="n">gr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

                    <span class="c1">###########################################################################</span>
                    <span class="c1"># Projection des individus</span>
                    <span class="c1">###########################################################################</span>

                    <span class="c1"># Initialisation du graphique de projection des individus</span>
                    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">axe_lim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">])</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">axe_lim</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">axe_lim</span><span class="p">)</span>

                    <span class="c1"># ajouter les axes</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;silver&quot;</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;silver&quot;</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">legend_patch</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">varSuppQual</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                                <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ind_spe</span><span class="p">):</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                            <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span>
                                            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                            <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span>
                                            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                        <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                                <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ind_spe</span><span class="p">):</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                            <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;green&quot;</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                            <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>

                        <span class="n">adjust_text</span><span class="p">(</span>
                            <span class="n">texts</span><span class="p">,</span> 
                            <span class="n">expand_text</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                            <span class="n">expand_points</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                            <span class="n">expand_objects</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                            <span class="n">expand_align</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                            <span class="n">force_points</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
                        <span class="p">)</span>

                        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                                <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ind_spe</span><span class="p">):</span>
                                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">)</span>

                        <span class="n">m1</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[:,</span> <span class="n">d1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                        <span class="n">m2</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[:,</span> <span class="n">d2</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_c</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">dic</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">group</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                        <span class="n">m1_tous_clusters</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">m2_tous_clusters</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">df_c_reset</span> <span class="o">=</span> <span class="n">df_c</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                        <span class="n">df_c_gb</span> <span class="o">=</span> <span class="n">df_c</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                        <span class="n">df_c_gb</span> <span class="o">=</span> <span class="n">df_c_gb</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">inv_dic</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_c</span><span class="p">[</span><span class="n">group</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                            <span class="n">z</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                            <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                    <span class="n">coord</span><span class="p">[</span><span class="n">selected</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span>
                                    <span class="n">coord</span><span class="p">[</span><span class="n">selected</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span>
                                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                                    <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                                    <span class="n">c</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="n">z</span><span class="p">],</span>
                                <span class="p">)</span>

                            <span class="n">m1</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">selected</span><span class="p">,</span> <span class="n">d1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            <span class="n">m2</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">selected</span><span class="p">,</span> <span class="n">d2</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            <span class="n">m1_tous_clusters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
                            <span class="n">m2_tous_clusters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>

                            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span>
                            <span class="p">)</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">leg_lab</span> <span class="o">=</span> <span class="n">group</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="n">inv_dic</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">leg_lab</span> <span class="o">=</span> <span class="n">group</span> <span class="o">+</span> <span class="s2">&quot; : groupe &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                            <span class="n">legend_patch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">Line2D</span><span class="p">(</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                                    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="n">z</span><span class="p">],</span>
                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="n">leg_lab</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;centroides_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">m1_tous_clusters</span><span class="p">,</span>
                            <span class="n">m2_tous_clusters</span><span class="p">,</span>
                        <span class="p">]</span>

                        <span class="c1"># détermination de la palette couleur</span>
                        <span class="n">nb_col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_c</span><span class="p">[</span><span class="n">group</span><span class="p">]))</span>
                        <span class="n">palette_perso</span> <span class="o">=</span> <span class="n">palette_perso</span><span class="p">[:</span><span class="n">nb_col</span><span class="p">]</span>

                        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">[:,</span> <span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">]]):</span>
                                <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df_c_reset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">group</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ind_spe</span><span class="p">):</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                            <span class="n">x</span><span class="p">,</span>
                                            <span class="n">y</span><span class="p">,</span>
                                            <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;9&quot;</span><span class="p">,</span>
                                            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                                <span class="n">facecolor</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                                <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="p">),</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                                    <span class="n">col_spe</span> <span class="o">=</span> <span class="n">palette_perso</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                            <span class="n">x</span><span class="p">,</span>
                                            <span class="n">y</span><span class="p">,</span>
                                            <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;9&quot;</span><span class="p">,</span>
                                            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">c</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="n">u</span><span class="p">],</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>

                        <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">[:,</span> <span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">]]):</span>
                                <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df_c_reset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">group</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ind_spe</span><span class="p">):</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                            <span class="n">x</span><span class="p">,</span>
                                            <span class="n">y</span><span class="p">,</span>
                                            <span class="n">i</span><span class="p">,</span>
                                            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;9&quot;</span><span class="p">,</span>
                                            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                                <span class="n">facecolor</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                                <span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;square,pad=0.2&quot;</span><span class="p">,</span>
                                            <span class="p">),</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                                    <span class="n">col_spe</span> <span class="o">=</span> <span class="n">palette_perso</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                                            <span class="n">x</span><span class="p">,</span>
                                            <span class="n">y</span><span class="p">,</span>
                                            <span class="n">i</span><span class="p">,</span>
                                            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="p">,</span>
                                            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                                            <span class="n">c</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="n">u</span><span class="p">],</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>
                    <span class="n">adjust_text</span><span class="p">(</span>
                        <span class="n">texts</span><span class="p">,</span> 
                        <span class="n">expand_text</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                        <span class="n">expand_points</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                        <span class="n">expand_objects</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                        <span class="n">expand_align</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span>
                        <span class="n">force_points</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">group_special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">legend_patch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">Line2D</span><span class="p">(</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                                    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">col_spe</span><span class="p">,</span>
                                    <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">col_spe</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;selection&quot;</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">legend_patch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">Line2D</span><span class="p">(</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                                    <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
                                    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Centroïde&quot;</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                        <span class="n">legend_groups</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                            <span class="n">handles</span><span class="o">=</span><span class="n">legend_patch</span><span class="p">,</span>
                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">),</span>
                            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
                            <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend_groups</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">legend_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">test_patch</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df_c_reset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">group</span><span class="p">])</span>
                                <span class="n">test_patch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">palette_perso</span><span class="p">[</span><span class="n">u</span><span class="p">],</span>
                                        <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="p">)</span>
                                <span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">test_patch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
                                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
                                        <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                        <span class="n">fc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                        <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="p">)</span>
                                <span class="p">)</span>

                        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                            <span class="n">handles</span><span class="o">=</span><span class="n">test_patch</span><span class="p">,</span>
                            <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
                            <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">),</span>
                        <span class="p">)</span>

                    <span class="c1"># nom des ax1, avec le pourcentage d&#39;inertie expliqué</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
                        <span class="s2">&quot;F</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">%)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">d1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
                        <span class="s2">&quot;F</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">%)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">d2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Projection des individus sur F</span><span class="si">{</span><span class="n">d1</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> et F</span><span class="si">{</span><span class="n">d2</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">gr</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;proj_ind_sur_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">im_proj_pop</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;proj_ind_sur_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">im_proj_pop</span><span class="o">.</span><span class="n">size</span>
                    <span class="n">x_start</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">y_start</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">x_end</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="n">y_end</span> <span class="o">=</span> <span class="n">height</span>
                    <span class="n">im_proj_pop_temp</span> <span class="o">=</span> <span class="n">im_proj_pop</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">y_end</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">proj_ind</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;proj_ind_sur_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">im_proj_pop_temp</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">proj_ind</span><span class="p">)</span>
                    <span class="n">all_values</span><span class="p">[</span>
                        <span class="s2">&quot;graph_proj_ind_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">proj_ind</span>


                    <span class="c1">###########################################################################</span>
                    <span class="c1"># Cercle des corrélations</span>
                    <span class="c1">###########################################################################</span>

                    <span class="c1"># initialisation du graphique du cercle des corrélations</span>
                    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                        <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                                <span class="p">(</span><span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span>
                                <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                            <span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span>
                            <span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span>
                            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                            <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">ax2</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span>
                            <span class="n">Line2D</span><span class="p">(</span>
                                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">]],</span>
                                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">corvar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">]],</span>
                                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
                                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;variables_active&quot;</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="p">)</span>

                    <span class="k">if</span> <span class="n">varSupp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">vsQuanti</span> <span class="o">=</span> <span class="n">varSupp</span><span class="o">.</span><span class="n">values</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vsQuanti</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                                    <span class="n">varSupp</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                                    <span class="p">(</span><span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span> <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">]),</span>
                                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>
                            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">],</span>
                                <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span>
                                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="n">ax2</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span>
                                <span class="n">Line2D</span><span class="p">(</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d1</span><span class="p">]],</span>
                                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">corSupp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">d2</span><span class="p">]],</span>
                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;variables_illustratives&quot;</span><span class="p">,</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                    <span class="c1"># Ajustement du texte</span>
                    <span class="n">adjust_text</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

                    <span class="c1"># ajouter les axes des abscisses et des ordonnées</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

                    <span class="c1"># ajouter un cercle</span>
                    <span class="n">cercle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">cercle</span><span class="p">)</span>

                    <span class="c1"># nom des ax2, avec le pourcentage d&#39;inertie expliqué</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
                        <span class="s2">&quot;F</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">%)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">d1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
                        <span class="s2">&quot;F</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">%)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="n">d2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">acp</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cercle des corrélations de F</span><span class="si">{</span><span class="n">d1</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> et F</span><span class="si">{</span><span class="n">d2</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="c1"># légende</span>
                    <span class="n">darkred_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Variables actives&quot;</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">varSupp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">green_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span>
                            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Variables illustratives&quot;</span>
                        <span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">darkred_patch</span><span class="p">,</span> <span class="n">green_patch</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">darkred_patch</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

                    <span class="n">gr</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;graph_combo_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">combo_name</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;graph_combo_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">all_values</span><span class="p">[</span>
                        <span class="s2">&quot;graph_combo_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">combo_name</span>

                    <span class="n">gr</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;cercle_cor_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">im_corr</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;cercle_cor_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">im_corr</span><span class="o">.</span><span class="n">size</span>
                    <span class="n">x_start</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="n">y_start</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">x_end</span> <span class="o">=</span> <span class="n">width</span>
                    <span class="n">y_end</span> <span class="o">=</span> <span class="n">height</span>
                    <span class="n">im_corr_temp</span> <span class="o">=</span> <span class="n">im_corr</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="n">x_start</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">y_end</span><span class="p">))</span>
                    <span class="n">cercle_cor</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;apc_graphs/&quot;</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">version_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">version_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;cercle_cor_</span><span class="si">{}</span><span class="s2">_et_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">im_corr_temp</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">cercle_cor</span><span class="p">)</span>
                    <span class="n">all_values</span><span class="p">[</span>
                        <span class="s2">&quot;cercle_cor_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">cercle_cor</span>

                    <span class="c1"># affichage</span>
                    <span class="k">if</span> <span class="n">data_only</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>


    <span class="c1">###########################################################################</span>
    <span class="c1"># Afficher les données pour un individu particulier</span>
    <span class="c1">###########################################################################</span>
    <span class="n">wind</span> <span class="o">=</span> <span class="n">df_global_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="n">wind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">cf_reset</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">liste_facteurs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">liste_facteurs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">cf_reset</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">liste_facteurs</span>
    <span class="n">cos2_ind</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">liste_facteurs</span>
    <span class="n">ctr_ind</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">liste_facteurs</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">wind</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">wind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">liste_indice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">wind</span><span class="p">[</span><span class="s2">&quot;indice&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">liste_indice</span>

    <span class="c1"># si labels_ind =&gt; on remplace l&#39;index par col &quot;indice&quot;</span>
    <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">old_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s2">&quot;indice&quot;</span><span class="p">]</span>
        <span class="n">ind_name</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">wind</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;ITEM&#39;</span>
        <span class="n">wind</span><span class="p">[</span><span class="n">ind_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">index</span>
        <span class="n">wind</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;indice&quot;</span><span class="p">)</span>
        <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind_name</span><span class="p">]</span>
        <span class="n">new_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">old_cols</span><span class="p">)</span>
        <span class="n">wind</span> <span class="o">=</span> <span class="n">wind</span><span class="p">[</span><span class="n">new_cols</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">affichage_infos_obs</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">cf_reset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cf_reset</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">ind</span><span class="p">]</span>
        <span class="n">df2_c</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df2_c</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Coord Fact&quot;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">T</span>

        <span class="n">df3</span> <span class="o">=</span> <span class="n">cos2_ind</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cos2_ind</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">ind</span><span class="p">]</span>
        <span class="n">df3_c</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df3_c</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;COS²&quot;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">df3_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">T</span>

        <span class="n">rang_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ctr_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">ctr_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">ind</span><span class="p">]</span>
            <span class="n">rang_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;rang&quot;</span><span class="p">])</span>
        <span class="n">df4</span> <span class="o">=</span> <span class="n">ctr_ind</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ctr_ind</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">ind</span><span class="p">]</span>
        <span class="n">df4_c</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df4_c</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ctr&quot;</span>
        <span class="n">df4</span> <span class="o">=</span> <span class="n">df4_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">T</span>

        <span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df5</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;coord. fact.&quot;</span><span class="p">,</span> <span class="s2">&quot;COS²&quot;</span><span class="p">,</span> <span class="s2">&quot;Contribution&quot;</span><span class="p">]</span>
        <span class="n">df5</span> <span class="o">=</span> <span class="n">df5</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">cols_del</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;indice&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols_del</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="n">df5</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ctr_ind</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Contribution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">df5</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ctr_ind</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Contribution&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;% (&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rang_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="o">+</span> <span class="s2">&quot;e contributeur)&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df5</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select_element</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df1</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wind</span><span class="p">[</span><span class="s2">&quot;indice&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">element</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">affichage_infos_obs</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df1</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wind</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">element</span><span class="p">]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;indice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">affichage_infos_obs</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;select_numero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wind</span><span class="p">)):</span>
            <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;select_numero&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_element</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;select_obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obss</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wind</span><span class="p">)):</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">obss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">all_values</span><span class="p">[</span><span class="s2">&quot;select_obs&quot;</span><span class="p">][</span><span class="n">obs</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_element</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">graph_only</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|          Data d&#39;un individu en particulier            |&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;La key &quot;select_obs&quot; du return renvoie le dictionnaire suivant :&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - key : &#39;</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;les indices des &#39;</span> <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;les &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;valeurs de la variable des observations (cf. la variable en index du df initial)&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - value : tuple de 2 df :&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    - df des données initiales&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    - df des données calculées pour cet individu :&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        - ses coordonnées factorielles&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        - sa qualité de représentation sur les différents axes (cf. COS²)&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        - sa contribution aux différents axes&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">serach_str</span> <span class="o">=</span> <span class="s2">&quot;l&#39;indice recherché soit 3 :&quot;</span> <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;la valeur recherchée soit &#39;obs3&#39; :&quot;</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="s2">&quot;3&quot;</span> <span class="k">if</span> <span class="n">labels_ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;obs3&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ex : en supposant que le nom donné à l</span><span class="se">\&#39;</span><span class="s1">exécution de la fonction soit &quot;resultat_acp&quot; et que &#39;</span><span class="o">+</span><span class="n">serach_str</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - resultat_acp[&quot;select_obs&quot;][&quot;&#39;</span><span class="o">+</span><span class="n">vv</span><span class="o">+</span><span class="s1">&#39;&quot;][0] pour afficher le df de données initiales&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - resultat_acp[&quot;select_obs&quot;][&quot;&#39;</span><span class="o">+</span><span class="n">vv</span><span class="o">+</span><span class="s1">&#39;&quot;][1] pour afficher le df de données calculées de l</span><span class="se">\&#39;</span><span class="s1">individu recherché&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data_only</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Traitement terminé&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resultats_test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Les différents tests de vérification sont positifs : pas de problème détecté&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Attention : un ou plusieurs tests de vérification ne se sont pas correctement déroulés : </span><span class="se">\</span>
<span class="s2">            un ou plusieurs problèmes ont été détectés</span><span class="se">\n</span><span class="s2">(voir la variable &#39;resultats_tests&#39; pour plus d&#39;infos)&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_values</span>
</code></pre>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </details>
                                </div>

                            </div>



                        </div>

                    </div>

                </div>
                <h2 id="4-exemple">4. Exemple</h2>
                <p>Exemple d'utilisation diponible au format <a href="https://kopadata.fr/data/generateACP/analyse_acp_exemple.html"
                        target="blank">HTML</a> ou au format notebook&nbsp;:<br>
                    &nbsp;&nbsp;&nbsp;- exemple exécuté dans le dossier <a
                        href="https://github.com/FredGainza/generateACP/tree/main/docs" target="_blank">/doc/</a> du
                    dépôt GitHub<br>
                    &nbsp;&nbsp;&nbsp;- exemple à exécuter sur <a
                        href="https://mybinder.org/v2/gh/FredGainza/generateACP.git/HEAD" target="_blank">binder</a> (se
                    rendre dans le dossier /doc/ et lancer le notebook <em>binder_exemple_module_acp.ipynb</em>)
                </p>
                <h2 id="5-reference">5. Reference</h2>
                <ul>
                    <li>Ricco Rakotomalala - <a
                            href="https://tutoriels-data-mining.blogspot.com/2020/07/pratique-des-methodes-factorielles-avec.html">Pratique
                            des Méthodes Factorielles avec Python</a></li>
                    <li>François Husson - <a href="https://husson.github.io/img/cours_AnaDo_M2_intro.pdf">Rappels
                            d’analyse factorielle</a></li>
                    <li>Nicolas Rangeon - <a
                            href="https://openclassrooms.com/fr/courses/4525281-realisez-une-analyse-exploratoire-de-donnees">Réalisez
                            une analyse exploratoire de données</a></li>
                </ul>
                <h2 id="6-about">6. About</h2>
                <ul>
                    <li>Created by <a href="mailto:kopatiktak@gmail.com">FredGainza</a> - <a
                            href="https://github.com/FredGainza">GitHub</a> - <a href="https://fgainza.fr">WebSite</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <footer class="col-md-12">
        <hr>
        <p>Documentation générée avec <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
    </footer>
    <script>
        var base_url = ".",
            shortcuts = {
                "help": 191,
                "next": 78,
                "previous": 80,
                "search": 83
            };
    </script>
    <script src="js/base.js" defer></script>

    <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="keyboardModalLabel">Raccourcis Clavier</h4>
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Fermer</span></button>
                </div>
                <div class="modal-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 20%;">Touches</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="help shortcut"><kbd>?</kbd></td>
                                <td>Ouvrir l'aide</td>
                            </tr>
                            <tr>
                                <td class="next shortcut"><kbd>n</kbd></td>
                                <td>Page suivante</td>
                            </tr>
                            <tr>
                                <td class="prev shortcut"><kbd>p</kbd></td>
                                <td>Page précédente</td>
                            </tr>
                            <tr>
                                <td class="search shortcut"><kbd>s</kbd></td>
                                <td>Rechercher</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

</body>

</html>

<!--
MkDocs version : 1.4.2
Build Date UTC : 2022-11-21 18:42:47.983792+00:00
-->